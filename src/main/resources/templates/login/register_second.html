<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="/static/css/bootstrap.min.css" />
		<link rel="stylesheet" href="/static/css/css_lxn/register-lxn.css" />
		<script type="text/javascript" src="/static/js/jquery.min.js"></script>
		<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="/static/css/animate.css" />
		<link rel="stylesheet" href="/static/css/font-awesome.css" />

		<!-- jQuery Validation plugin javascript-->
		<script src="/static/js/plugins/validate/jquery.validate.min.js"></script>
		<script src="/static/js/plugins/validate/messages_zh.min.js"></script>
		<script type="text/javascript" src="/static/js/js_lxn/register_validate.js"></script>
		<script src="/static/js/vue.js"></script>
	</head>

	<body>
		<div class="container-fluid">
			<div class="contest">
				<div class="contop col-md-12">
					<div class="topimg col-md-11">
						<img src="/static/img/img_hlj/logo2.png" alt="" />
					</div>
					<div class="topmeg col-md-1">
						<span><a href="#">首页</a></span>
						<span>|</span>
						<span><a href="#">帮助</a></span>
					</div>
				</div>
				<div class="conbottom col-md-12">
					<div class="bottop text-center">
						<p>注册新用户</p>
					</div>
					<div class="botimg text-center col-md-12">
						<img src="/static/img/img_hlj/process_bg_2.png" alt="" />
					</div>
					<div class="botmeg col-md-12">
						<span class="botmegspan1 col-md-4">邮箱验证</span>
						<span class="botmegspan2 col-md-4">填写信息</span>
						<span class="botmegspan3 col-md-4">注册成功</span>
					</div>
					<div class="botform col-md-12">
						<div class="formmeg col-md-12" id="register">
							<form class="form-horizontal" id="signupForm">
								<div class="form-group">
									<div class="col-md-5">
										<div class="input-group">
											<span class="input-group-addon glyphicon glyphicon-envelope"></span>
											<input type="text" class="form-control" placeholder=""  disabled="disabled" v-model="userAccount.allEmail"/>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="col-md-5">
										<div class="input-group">
											<span class="input-group-addon glyphicon glyphicon-user"></span>
											<input type="text" class="form-control" placeholder="用户名" id="name" name="name" v-model="userInfo.promName"/>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="col-md-5">
										<div class="input-group">
											<span class="input-group-addon glyphicon glyphicon-lock"></span>
											<input type="text" class="form-control" placeholder="登陆密码" id="password" name="password" v-model="userAccount.allPwd"/>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="col-md-5">
										<div class="input-group">
											<span class="input-group-addon glyphicon glyphicon-phone"></span>
											<input type="text" class="form-control" placeholder="手机号码" id="phone" name="phone" v-model="userInfo.promPhone"/>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="col-md-5">
										<div class="input-group">
											<span class="input-group-addon glyphicon glyphicon-yen"></span>
											<input type="text" class="form-control" placeholder="支付宝账号" id="pay" name="pay" v-model="userInfo.promAbipay"/>
										</div>
									</div>
								</div>
								<!--<div class="form-group">-->
									<!--<div class="col-md-5">-->
										<!--<div class="input-group">-->
											<!--<span class="input-group-addon glyphicon glyphicon-lock"></span>-->
											<!--<input type="text" class="form-control" placeholder="6位支付密码" id="paypwd" name="paypwd" v-model="userInfo.promPaypwd"/>-->
										<!--</div>-->
									<!--</div>-->
								<!--</div>-->
								<div class="form-group">
								<div class="col-sm-5">
									<div class="checkbox">
										<label>
                                            <input type="checkbox" class="checkbox" id="agree" name="agree" style="margin-top: -4px;"> 我已经认真阅读并同意《创客网使用协议》
                                        </label>
									</div>
								</div>
								</div>
								<div class="form-group">
									<div class="col-md-5">
										<div class="input-group">
											<button type="button" class="btn sub_register" @click="register">&nbsp;&nbsp;注册&nbsp;&nbsp;</button>
										</div>
									</div>
								</div>
							</form>
						</div>
						<script type="text/javascript">
                            /*<![CDATA[*/
                            contextPath = /*[[@{/}]]*/ '';
                            /*]]>*/
                            var vm = new Vue({
                                el:'#register',
                                data:{
                                    userId: "",
                                    userAccount:'',
									userInfo:''
                                },
                                beforeCreate: function () {
                                },
                                created: function () {
                                    this.getUser();
                                },
                                beforeMount: function () {
                                },
                                mounted: function () {
                                },
                                beforeUpdate: function () {
                                },
                                updated: function () {
                                },
                                beforeDestroy: function () {
                                },
                                destroyed: function () {
                                },
                                methods: {
                                    urlparse: function(){
                                        var url = window.location.href;
                                        var a = document.createElement('a');
                                        a.href = url;
                                        var obj = {
                                            source: url,
                                            protocol: a.protocol.replace(':', ''),
                                            host: a.hostname,
                                            port: a.port,
                                            query: a.search,
                                            file: (a.pathname.match(/\/([^\/?#]+)$/i) || [, ''])[1],
                                            hash: a.hash.replace('#', ''),
                                            path: a.pathname.replace(/^([^\/])/, '/$1'),
                                            relative: (a.href.match(/tps?:\/\/[^\/]+(.+)/) || [, ''])[1],
                                            segments: a.pathname.replace(/^\//, '').split('/'),
                                            params: (function() {
                                                var ret = {};
                                                var seg = a.search.replace(/^\?/, '').split('&').filter(function(v,i){
                                                    if (v!==''&&v.indexOf('=')) {
                                                        return true;
                                                    }
                                                });
                                                seg.forEach( function(element, index) {
                                                    var idx = element.indexOf('=');
                                                    var key = element.substring(0, idx);
                                                    var val = element.substring(idx+1);
                                                    ret[key] = val;
                                                });
                                                return ret;
                                            })()
                                        };
                                        return obj;
                                    },
									getUser: function(){
                                        var obj = this.urlparse();
                                        var data = "UUID="+obj.params.UUID;
                                        $.ajax({
                                            type: "POST",
                                            url: "/registered/getUserByID",
                                            data: data,
                                            dataType: "json",
                                            success: function(result){
                                                if(result.code === 0){
                                                    vm.userAccount = result.userAccount;
                                                    vm.userInfo = result.userInfo;
                                                    console.log(vm.userAccount);
                                                }else{
                                                    alert("出现错误");
                                                }
                                            }
                                        });
									},
                                    register: function () {
                                        var data1 = vm.userAccount;
                                        var data2 = vm.userInfo;
                                        $.ajax({
                                            type: "POST",
                                            url: "/registered/setUserInfo",
                                            data:  JSON.stringify({data1, data2}),
                                            contentType:"application/json;charset=utf-8",
                                            dataType: "json",
                                            success: function(result){
                                                if(result.code === 0){
                                                    window.location.href = "/registered/third";
                                                }else{
                                                    alert("出现错误");
                                                }
                                            },
                                            error: function () {
                                                alert("出现错误");
                                            }
                                        });
                                    },
                                }
                            });
						</script>
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript">
						
			$(".sub_register").click(function(){
				window.location.href="#";
			})
						
		</script>
	</body>

</html>